<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">

<h:head>
    <title>Manage Users</title>

    <!-- Bootstrap & Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"/>
    <link rel="stylesheet" href="css/adminCss.css"/>
    <link rel="stylesheet" href="css/sidebar_header_css.css"/>

    <style>
        /* Page Title */
        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: #333;
        }

        /* Add User Button */
        .btn-add-user {
            background-color: #0d6efd;
            color: #fff;
            padding: 10px 16px;
            border-radius: 8px;
            font-weight: 600;
            border: none;
        }

        /* Table Container */
        .data-table-container {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.06);
            overflow: hidden;
            border: 1px solid #e9eef2;
            margin-top: 20px;
        }

        /* Table */
        .user-table {
            width: 100%;
            border-collapse: collapse;
        }
        .user-table th {
            background-color: #f8f9fa;
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
            font-weight: 600;
        }
        .user-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        /* Pagination */
        .premium-pagination {
            list-style: none;
            display: flex;
            gap: 10px;
            padding-left: 0;
        }
        .premium-pagination li {
            padding: 6px 12px;
            border-radius: 6px;
            background: #f1f1f1;
        }
        .premium-pagination li.active {
            background: #0d6efd;
            color: white;
            font-weight: bold;
        }
        .premium-pagination li.disabled {
            opacity: 0.4;
            pointer-events: none;
        }
        .premium-pagination li a {
            text-decoration: none;
            color: inherit;
        }

    </style>

</h:head>

<h:body>

    <div class="sticky-header-wrapper">
        <ui:include src="/adminHeader.xhtml" />
    </div>

    <div class="main-layout">

        <ui:include src="sidebar.xhtml"/>

        <div class="main-content">

            <h:form id="listForm">

                <!-- HEADER -->
                <div class="content-header d-flex justify-content-between align-items-center">
                    <h2 class="page-title">Manage Users</h2>

                    <h:commandButton value="+ Add User"
                                     action="#{adminUserBean.goToAddPage}"
                                     styleClass="btn-add-user"/>
                </div>

                <!-- TABLE -->
                <div class="data-table-container">

                    <h:dataTable value="#{adminUserBean.pagedUsers}" var="u" styleClass="user-table">

                        <h:column>
                            <f:facet name="header">ID</f:facet>
                            #{u.id}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Username</f:facet>
                            #{u.username}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Full name</f:facet>
                            #{u.fullname}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Email</f:facet>
                            #{u.email}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Phone</f:facet>
                            #{u.phone}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Group</f:facet>
                            #{u.groupid != null ? u.groupid.groupname : ''}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Active</f:facet>
                            #{u.status}
                        </h:column>

                        <h:column>
                            <f:facet name="header">Actions</f:facet>

                            <!-- EDIT -->
                            <h:commandLink action="#{adminUserBean.editUser(u.id)}" title="Edit"
                                           styleClass="btn btn-sm p-1">
                                <i class="bi bi-pencil-square text-success fs-5"></i>
                            </h:commandLink>

                            <!-- DELETE -->
                            <h:commandLink action="#{adminUserBean.deleteUser(u.id)}"
                                           onclick="return confirm('Delete user #{u.username}?')"
                                           title="Delete" styleClass="btn btn-sm p-1">
                                <i class="bi bi-trash text-danger fs-5"></i>
                            </h:commandLink>

                        </h:column>

                    </h:dataTable>

                    <!-- PAGINATION -->
                    <div class="pagination-container d-flex justify-content-center mt-4">

                        <ul class="premium-pagination">

                            <!-- Prev -->
                            <li class="#{adminUserBean.pageNumber == 1 ? 'disabled' : ''}">
                                <h:commandLink action="#{adminUserBean.previousPage}">
                                    <f:ajax render="@form"/>
                                    <i class="bi bi-chevron-left"></i>
                                </h:commandLink>
                            </li>

                            <!-- Page display -->
                            <li class="active">
                                #{adminUserBean.pageNumber} / #{adminUserBean.totalPages}
                            </li>

                            <!-- Next -->
                            <li class="#{adminUserBean.pageNumber == adminUserBean.totalPages ? 'disabled' : ''}">
                                <h:commandLink action="#{adminUserBean.nextPage}">
                                    <f:ajax render="@form"/>
                                    <i class="bi bi-chevron-right"></i>
                                </h:commandLink>
                            </li>

                        </ul>

                    </div>
                </div>

            </h:form>

        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</h:body>
</html>
