<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html"
      xmlns:f="jakarta.faces.core"
      xmlns:ui="jakarta.faces.facelets">

    <h:head>
        <title>Book Details</title>

        <!-- Bootstrap & Icons -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"/>

        <style>
            body {
                background: #f5f7fb;
                font-family: 'Segoe UI', sans-serif;
            }

            .sticky-header-wrapper {
                position: fixed;
                top: 0;
                left: 0;
                right: 0;
                z-index: 1030;
                background-color: white;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                height: 65px;
            }

            .book-details-container {
                max-width: 1000px;
                margin: 120px auto 40px; /* space for sticky header */
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
                padding: 30px;
            }

            /* Carousel */
            .carousel img {
                width: 100%;
                height: auto;
                max-height: 450px;
                border-radius: 8px;
            }

            /* Book Info */
            .book-title {
                font-size: 2.2rem;
                font-weight: 700;
                margin-bottom: 10px;
            }

            .book-author {
                font-size: 1.1rem;
                color: #6c757d;
                margin-bottom: 15px;
            }

            .book-price {
                font-size: 1.7rem;
                font-weight: 700;
                color: #28a745;
                margin-bottom: 20px;
            }

            .book-description {
                font-size: 1rem;
                color: #555;
                margin-bottom: 25px;
                line-height: 1.6;
            }

            /* Buttons */
            .btn-back {
                background: #333;
                color: white;
                padding: 12px 22px;
                border-radius: 6px;
                text-decoration: none;
                margin-right: 10px;
                transition: all 0.3s ease;
            }

            .btn-back:hover {
                background: #555;
                transform: translateY(-2px);
            }

            .btn-cart, .btn-buy {
                background: #28a745;
                color: white;
                padding: 12px 22px;
                border-radius: 6px;
                font-weight: 600;
                margin-right: 10px;
                transition: all 0.3s ease;
                box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            }

            .btn-cart:hover, .btn-buy:hover {
                background: #218838;
                transform: translateY(-3px);
                box-shadow: 0 6px 12px rgba(0,0,0,0.15);
            }

            .btn-buy i, .btn-cart i {
                margin-right: 6px;
                transition: transform 0.3s;
            }

            .btn-buy:hover i, .btn-cart:hover i {
                transform: scale(1.2);
            }

            @media(max-width: 768px) {
                .book-details-container {
                    margin: 100px 15px;
                    padding: 20px;
                }
                .carousel img {
                    max-height: 300px;
                }
            }
            #jakarta_faces_developmentstage_messages {
                display: none !important;
            }
            /* Stock Badge Styles */
            .stock-badge {
                position: absolute;
                top: 20px;
                right: 20px;
                z-index: 10;
            }

            .stock-badge .badge {
                padding: 0.6rem 1.2rem;
                font-size: 1rem;
                font-weight: 700;
                border-radius: 50px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                display: flex;
                align-items: center;
                gap: 0.5rem;
                transition: transform 0.3s, box-shadow 0.3s;
            }

            .stock-badge .badge.bg-success {
                background: linear-gradient(135deg, #28a745, #71dd8a);
                color: #fff;
            }

            .stock-badge .badge.bg-danger {
                background: linear-gradient(135deg, #dc3545, #f87278);
                color: #fff;
            }

            .stock-badge .badge:hover {
                transform: scale(1.05);
                box-shadow: 0 6px 16px rgba(0,0,0,0.25);
            }

            /* Optional: animated pulse for in-stock badge */
            .stock-badge .badge.bg-success {
                animation: pulse 2s infinite;
            }

            @keyframes pulse {
                0% {
                    transform: scale(1);
                }
                50% {
                    transform: scale(1.08);
                }
                100% {
                    transform: scale(1);
                }
            }

            /* Icons sizing */
            .stock-badge .bi {
                font-size: 1.2rem;
            }

            .book-details-container {
                position: relative; /* ðŸ‘ˆ REQUIRED */
                max-width: 1000px;
                margin: 120px auto 40px;
                background: #fff;
                border-radius: 12px;
                box-shadow: 0 10px 25px rgba(0,0,0,0.1);
                padding: 30px;
            }

            /* Disabled buttons styling */
            button:disabled,
            .btn-cart:disabled,
            .btn-buy:disabled {
                background-color: #adb5bd !important; /* grey */
                border-color: #adb5bd !important;
                color: #ffffff !important;
                cursor: not-allowed !important;
                box-shadow: none !important;
                transform: none !important;
                opacity: 0.8;
            }

            /* Disable hover effect */
            button:disabled:hover,
            .btn-cart:disabled:hover,
            .btn-buy:disabled:hover {
                background-color: #adb5bd !important;
                transform: none !important;
            }

        </style>
    </h:head>

    <h:body>
        <!-- Header -->
        <div class="sticky-header-wrapper">
            <ui:include src="/header.xhtml"/>
        </div>

        <h:form>
            <!-- Book Details Container -->
            <div class="book-details-container">
                <div class="stock-badge">
                    <h:panelGroup rendered="#{bookBean.selectedBook.available gt 0}">
                        <span class="badge bg-success fs-6 px-3 py-2">
                            <i class="bi bi-check-circle"></i> In Stock
                        </span>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{bookBean.selectedBook.available eq 0}">
                        <span class="badge bg-danger fs-6 px-3 py-2">
                            <i class="bi bi-x-circle"></i> Out of Stock
                        </span>
                    </h:panelGroup>
                </div>

                <div class="row">
                    <!-- Left: Carousel -->
                    <div class="col-md-6 mb-4">
                        <div id="bookCarousel" class="carousel slide" data-bs-ride="carousel">
                            <div class="carousel-inner">
                                <div class="carousel-item active">
                                    <h:graphicImage value="/BookStore/BookStoreUploads/#{bookBean.selectedBook.coverPhoto}"
                                                    rendered="#{not empty bookBean.selectedBook.coverPhoto}" />
                                </div>
                                <div class="carousel-item">
                                    <h:graphicImage value="/BookStore/BookStoreUploads/#{bookBean.selectedBook.frontPagePhoto}"
                                                    rendered="#{not empty bookBean.selectedBook.frontPagePhoto}" />
                                </div>
                                <div class="carousel-item">
                                    <h:graphicImage value="/BookStore/BookStoreUploads/#{bookBean.selectedBook.lastPagePhoto}"
                                                    rendered="#{not empty bookBean.selectedBook.lastPagePhoto}" />
                                </div>
                            </div>
                            <button class="carousel-control-prev" type="button" data-bs-target="#bookCarousel" data-bs-slide="prev">
                                <span class="carousel-control-prev-icon"></span>
                            </button>
                            <button class="carousel-control-next" type="button" data-bs-target="#bookCarousel" data-bs-slide="next">
                                <span class="carousel-control-next-icon"></span>
                            </button>
                        </div>
                    </div>

                    <!-- Right: Book Details -->
                    <div class="col-md-6 d-flex flex-column justify-content-center">
                        <h2 class="book-title">#{bookBean.selectedBook.bookname}</h2>
                        <p class="book-author">by #{bookBean.selectedBook.authorname}</p>
                        <p class="book-price">â‚¹#{bookBean.selectedBook.price}</p>

                        <p class="book-description">
                            <!-- Example description -->
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Suspendisse varius enim in eros elementum tristique. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.
                        </p>

                        <p class="text-muted mb-2">
                            <strong>Available Quantity:</strong>
                            <span class="#{bookBean.selectedBook.available gt 0 ? 'text-success' : 'text-danger'}">
                                #{bookBean.selectedBook.available}
                            </span>
                        </p>
                        <br/>
                        <div class="d-flex flex-wrap">
                            <h:commandLink value="Back to Books"
                                           action="UserBookList.xhtml?faces-redirect=true"
                                           styleClass="btn-back" />

                            <!-- Add to Cart: stay on same page -->
                            <h:commandButton value="Add to Cart"
                                             styleClass="btn-cart"
                                             action="#{cartBean.addToCart}"
                                             disabled="#{bookBean.selectedBook.available le 0}">
                                <f:param name="bookId" value="#{bookBean.selectedBook.id}" />
                            </h:commandButton>

                            <h:commandButton value="Buy Now"
                                             styleClass="btn-buy"
                                             action="#{cartBean.buyNow}"
                                             disabled="#{bookBean.selectedBook.available le 0}">
                                <f:param name="bookId" value="#{bookBean.selectedBook.id}" />
                            </h:commandButton>




                        </div>
                    </div>
                </div>
            </div>
        </h:form>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    </h:body>
</html>
