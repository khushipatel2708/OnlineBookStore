<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="jakarta.faces.html">

    <h:head>
        <title>User Dashboard</title>
        <link rel="stylesheet" href="bootstrap/css/bootstrap.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"/>

        <style>
            :root {
                --bs-primary: #0066cc;
                --bs-info: #0d6efd;
            }

            .bookstore-header {
                background-color: white;
                border-bottom: 1px solid #dee2e6;
                padding: 10px 0;
            }

            .logo-text {
                font-weight: 700;
                color: var(--bs-primary);
                font-size: 1.5rem;
                margin-left: 0.5rem;
            }

            .nav-link.active-header-link {
                color: var(--bs-primary) !important;
                font-weight: 600;
            }

            .btn-admin {
                color: var(--bs-primary);
                border-color: var(--bs-primary);
                background-color: transparent;
            }
            .btn-admin:hover {
                color: white;
                background-color: var(--bs-primary);
                border-color: var(--bs-primary);
            }

            .dashboard-content {
                padding: 20px 40px;
            }
          /* Show dropdown on hover */
.dropdown:hover .dropdown-menu {
    display: block;
}

/* Ensure dropdown stays aligned right */
.dropdown-menu-end {
    right: 0;
    left: auto;
    margin-top: 0; /* Optional: removes gap under button */
}


        </style>
    </h:head>

    <h:body class="bg-light">

        <!-- Entire header inside one form -->
        <h:form id="headerForm">
            <header class="bookstore-header shadow-sm">
                <div class="container-fluid d-flex align-items-center justify-content-between px-4">

                    <!-- Logo -->
                    <div class="d-flex align-items-center">
                        <i class="bi bi-book-half fs-3 text-primary"></i>
                        <span class="logo-text">BookStore</span>
                    </div>

                    <!-- Navigation links (can remain outside command form if static links) -->
                    <nav class="d-none d-lg-block">
                        <ul class="nav">
                            <li class="nav-item">
                                <h:outputLink value="user.jsf" styleClass="nav-link active-header-link">Home</h:outputLink>
                            </li>
                            <li class="nav-item">
                                <h:outputLink value="UserBookList.jsf" styleClass="nav-link text-secondary">Books</h:outputLink>
                            </li>
                            <li class="nav-item">
                                <h:outputLink value="shippingForm.jsf" styleClass="nav-link text-secondary">Shipping</h:outputLink>
                            </li>
                            <li class="nav-item">
                                <h:outputLink value="about.jsf" styleClass="nav-link text-secondary">About</h:outputLink>
                            </li>
                            <li class="nav-item">
                                <h:outputLink value="contactus.jsf" styleClass="nav-link text-secondary">Contact</h:outputLink>
                            </li>
                        </ul>
                    </nav>

                    <!-- Right-side elements (search, cart, profile) -->
                    <div class="d-flex align-items-center">

                        <!-- Search -->
                        <div class="input-group me-3" style="width: 250px;">
                            <input type="text" class="form-control form-control-sm" placeholder="Search books..." aria-label="Search books"/>
                            <span class="input-group-text bg-white text-muted border-start-0"><i class="bi bi-search"></i></span>
                        </div>

                        <!-- Cart (commandLink now inside h:form) -->
                        <h:commandLink action="cartList?faces-redirect=true" 
                                       styleClass="position-relative me-3 text-secondary">
                            <i class="bi bi-cart3 fs-4"></i>

                            <h:panelGroup rendered="#{cartBean.cartCount > 0}">
                                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                                      style="font-size: 0.65rem;">
                                    #{cartBean.cartCount}
                                </span>
                            </h:panelGroup>
                        </h:commandLink>
                        
                        <!-- Conditional profile -->
                        <h:panelGroup rendered="#{not empty loginBean.loggedInUser}">
                            <div class="dropdown">
                                <button class="btn btn-sm btn-outline-primary btn-admin fw-bold rounded-pill d-flex align-items-center"
                                        type="button" id="profileDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="bi bi-person-fill me-1"></i>
                                    #{loginBean.loggedInUser.username}
                                    <i class="bi bi-caret-down-fill ms-1"></i>
                                </button>

                                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
                                    <li>
                                        <h:outputLink value="UserProfile.jsf" styleClass="dropdown-item d-flex align-items-center">
                                            Profile
                                        </h:outputLink>
                                    </li>
                                    <li>
                                        <!-- Separate form inside dropdown -->
                                        <h:form id="logoutForm">
                                            <h:commandButton action="#{loginBean.logout}" class="bi bi-box-arrow-right me-2"  value="logout" styleClass="dropdown-item d-flex align-items-center">
                                            </h:commandButton>
                                        </h:form>
                                    </li>

                                </ul>
                            </div>
                        </h:panelGroup>

                        <!-- Show login button if not logged in -->
                        <h:panelGroup rendered="#{empty loginBean.loggedInUser}">
                            <h:outputLink value="login.jsf" styleClass="btn btn-sm btn-outline-primary btn-admin fw-bold rounded-pill">
                                <i class="bi bi-box-arrow-in-right me-1"></i> Login
                            </h:outputLink>
                        </h:panelGroup>
                    </div>
                </div>
            </header>
        </h:form>

        <!-- Main dashboard content -->
        <!--<div class="container dashboard-content">
        </div>-->

        <script src="bootstrap/js/bootstrap.bundle.min.js"></script>
    </h:body>
</html>
