<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
<h:body>

    <!-- =============== ACCESS CONTROL =============== -->
    <h:panelGroup rendered="#{not bookBean.admin}">
        <h2 style="color:red;">Access Denied!</h2>
        <p>You must be Admin to access Add or Edit Book.</p>
        <h:link value="Go Back" outcome="user.xhtml" />
    </h:panelGroup>

    <!-- =============== ADMIN ONLY SECTION =============== -->
    <h:panelGroup rendered="#{bookBean.admin}">
<h:form enctype="multipart/form-data">

    <h:panelGroup rendered="#{not bookBean.editMode}">
        <h2>Add Book</h2>
    </h:panelGroup>

    <h:panelGroup rendered="#{bookBean.editMode}">
        <h2>Edit Book (ID: #{bookBean.id})</h2>
    </h:panelGroup>

    <h:outputLabel value="Book Name:"/>
    <h:inputText value="#{bookBean.bookname}" required="true"/>
    <br/><br/>

    <h:outputLabel value="Author:"/>
    <h:inputText value="#{bookBean.authorname}" required="true"/>
    <br/><br/>

    <h:outputLabel value="Price:"/>
    <h:inputText value="#{bookBean.price}" required="true"/>
    <br/><br/>

    <h:outputLabel value="Book Type:"/>
    <h:selectOneMenu value="#{bookBean.booktypeId}">
        <f:selectItems value="#{bookBean.allBooktypes}" var="bt"
                       itemValue="#{bt.id}" itemLabel="#{bt.type}"/>
    </h:selectOneMenu>
    <br/><br/>

    <!-- COVER -->
    <h3>Cover Photo</h3>
    <h:inputFile value="#{bookBean.coverPhoto}">
        <f:ajax event="change" listener="#{bookBean.setCoverPhoto(bookBean.coverPhoto)}"
                render="coverPreviewPanel"/>
    </h:inputFile>

    <h:panelGroup id="coverPreviewPanel">
        <h:panelGroup rendered="#{not empty bookBean.coverPreview}">
            <h:graphicImage value="#{bookBean.coverPreview}" width="150"/>
        </h:panelGroup>
    </h:panelGroup>

    <br/><br/>

    <!-- FRONT -->
    <h3>Front Page Photo</h3>
    <h:inputFile value="#{bookBean.frontPagePhoto}">
        <f:ajax event="change" listener="#{bookBean.setFrontPagePhoto(bookBean.frontPagePhoto)}"
                render="frontPreviewPanel"/>
    </h:inputFile>

    <h:panelGroup id="frontPreviewPanel">
        <h:panelGroup rendered="#{not empty bookBean.frontPreview}">
            <h:graphicImage value="#{bookBean.frontPreview}" width="150"/>
        </h:panelGroup>
    </h:panelGroup>

    <br/><br/>

    <!-- LAST -->
    <h3>Last Page Photo</h3>
    <h:inputFile value="#{bookBean.lastPagePhoto}">
        <f:ajax event="change" listener="#{bookBean.setLastPagePhoto(bookBean.lastPagePhoto)}"
                render="lastPreviewPanel"/>
    </h:inputFile>

    <h:panelGroup id="lastPreviewPanel">
        <h:panelGroup rendered="#{not empty bookBean.lastPreview}">
            <h:graphicImage value="#{bookBean.lastPreview}" width="150"/>
        </h:panelGroup>
    </h:panelGroup>

    <br/><br/>

    <h:panelGroup rendered="#{not bookBean.editMode}">
        <h:commandButton value="Add Book" action="#{bookBean.addBook}"/>
    </h:panelGroup>

    <h:panelGroup rendered="#{bookBean.editMode}">
        <h:commandButton value="Update Book" action="#{bookBean.updateBook}"/>
        <h:commandButton value="Cancel" action="#{bookBean.cancelEdit}"/>
    </h:panelGroup>

</h:form>
        </h:panelGroup>

</h:body>
</html>
